<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SnapIn</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="node_modules/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <style type='text/css'>
        .embeddedServiceHelpButton .helpButton .uiButton { background-color: #005290; font-family: "Salesforce Sans", sans-serif; }
        .embeddedServiceHelpButton .helpButton .uiButton:focus { outline: 1px solid #005290; }
        @font-face {
        font-family: 'Salesforce Sans';
        src: url('https://www.sfdcstatic.com/system/shared/common/assets/fonts/SalesforceSans/SalesforceSans-Regular.woff') format('woff'),
        url('https://www.sfdcstatic.com/system/shared/common/assets/fonts/SalesforceSans/SalesforceSans-Regular.ttf') format('truetype');
        }
    </style>
    <script src="main.js"></script>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-2"></div>
            <div class="col-lg-8">
                <form>
                    <div class="form-group">
                        <label for="serviceTag">Service Tag</label>
                        <input type="text" class="form-control"  id="serviceTag" aria-describedby="serviceTag" placeholder="Enter Service Tag" onblur="showIssue()">
                        <p>Based on asset warranty contact channel will be displayed</p>
                    </div>
                    <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Select Issue Type
                        </button>
                        <div id="issueDropdown" class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item" href="#">Slow Performance</a>
                            <a class="dropdown-item" href="#">Keyboard not working</a>
                            <a class="dropdown-item" href="#">Touch pad not working</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div id="contact-row" class="row">
            <div class="col-lg-2"></div>
            <div class="col-lg-8">
                <h3>Contact Options</h3>
                <div class="call-us">
                    <h5>Call Us</h5>
                    <p class="phone-no">1-855-305-9057</p>
                    <p>24/7</p>
                    <p>Please Note: You will be asked to enter your Express Service Code: <strong>34285956052</strong></p>
                </div>
                <div class="chat-with-us">
                    <h5>Chat with us</h5>
                    <p>Start a chat session with one of our technical support experts.</p>
                    <button type="button" id="chatButton" class="btn btn-primary" onclick="initChat()">Start Chat</button>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="node_modules/jquery/dist/jquery.min.js"></script>
<script src="https://unpkg.com/popper.js/dist/umd/popper.min.js"></script>
<script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
<script type='text/javascript'>
    $('.dropdown').hide();
    $('#contact-row').hide();
    $('#issueDropdown > a').click(function() {
        var val = $(this).text();
        if( val != 'Select Issue Type' ) {
            $('#dropdownMenuButton').text(val);
            $('#contact-row').show();
            if( document.getElementById('serviceTag').value.toLowerCase() === 'dtb4pc2' ) {
                $('.call-us').hide();
            } else {
                $('.call-us').show();
            }
        }
    });

    function showIssue() {
        if( $('#serviceTag').val().length != 0 ) {
            $('.dropdown').show();
        } else {
            $('.dropdown').hide();
            $('#dropdownMenuButton').text('Select Issue Type');
            $('#contact-row').hide();
        }
    }

    function initChat() {
        var buttonId, deploymentId;
        var issueVal = $('#dropdownMenuButton').text();
        var serviceTagVal = document.getElementById('serviceTag').value.toLowerCase();
        if( serviceTagVal === 'dtb4pc2' ) {
            buttonId = '573m00000004DC9';
            deploymentId = '572m00000004Ckx';
        } else if( serviceTagVal === 'lap0001' ) {
            buttonId = '573m00000004DCE';
            deploymentId = '572m00000004Cl2';
        }
        var initESW = function(gslbBaseURL, deploymentId, buttonId, serviceTagVal, issueVal) {
            embedded_svc.settings.displayHelpButton = true; //Or false
            embedded_svc.settings.language = ''; //For example, enter 'en' or 'en-US'

            //embedded_svc.settings.defaultMinimizedText = '...'; //(Defaults to Chat with an Expert)
            //embedded_svc.settings.disabledMinimizedText = '...'; //(Defaults to Agent Offline)

            //embedded_svc.settings.loadingText = ''; //(Defaults to Loading)
            //embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

            // Settings for Live Agent
            //embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
            // Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
            // Returns a valid button ID.
            //};
            //embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
            //embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
            //embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)

            embedded_svc.settings.enabledFeatures = ['LiveAgent'];
            embedded_svc.settings.entryFeature = 'LiveAgent';
            embedded_svc.settings.extraPrechatInfo = [{
                            "entityFieldMaps": [{
                                "doCreate":false,
                                "doFind":true,
                                "fieldName":"LastName",
                                "isExactMatch":true,
                                "label":"Last Name"
                            }, {
                                "doCreate":false,
                                "doFind":true,
                                "fieldName":"FirstName",
                                "isExactMatch":true,
                                "label":"First Name"
                            }, {
                                "doCreate":false,
                                "doFind":true,
                                "fieldName":"Email",
                                "isExactMatch":true,
                                "label":"Email"
                            }, {
                                "doCreate":false,
                                "doFind":true,
                                "fieldName":"Primary_Phone__c",
                                "isExactMatch":true,
                                "label":"Primary Phone Number"
                            }
                            ],
                            "entityName":"Contact"
                        }];
                    
                    embedded_svc.settings.extraPrechatFormDetails = [
                                                                    {"label":"First Name", "transcriptFields":["FirstName__c"]},
                                                                    {"label":"Last Name", "transcriptFields":["LastName__c"]},
                                                                    {"label":"Primary Phone Number", "transcriptFields":["ContactNumber__c"]},
                                                                    {"label":"Email Address", "transcriptFields":["Email__c"]},
                                                                    {"label":"Subject", "value":issueVal, "transcriptFields":["Issue__c"]},
                                                                    {"label":"Service Tag", "value": serviceTagVal, "transcriptFields":["Service_Tag__c"]},
                                                                    {"label":"Issue Description", "transcriptFields":["Description__c"]},
                                                                    {"label":"AccountNumber", "transcriptFields":["CustomerNumber__c"]},
                                                                    {"label":"Account BUID", "transcriptFields":["CustomerBUID__c"]},
                                                                    ];  
                                                                    
                    embedded_svc.settings.extraPrechatInfo = [{
                                                            "entityFieldMaps": [{
                                                            "doCreate": false,
                                                            "doFind": true,
                                                            "fieldName": "Name",
                                                            "isExactMatch": true,
                                                            "label": "Service Tag"
                                                            }],
                                                            "entityName": "Asset",
                                                            "saveToTranscript": "Asset__c"
                                                            }];
                                                        
                                                        
            
            embedded_svc.init('https://dellservices--DEV3.cs20.my.salesforce.com', 'https://dev3-dev2-dellservices--dev2.cs20.force.com/LA', gslbBaseURL, '00Dm0000000DQXs', 'Test_Snap_In', { baseLiveAgentContentURL: 'https://c.la4-c1cs-phx.salesforceliveagent.com/content', deploymentId: '572m00000004Ckx', buttonId: '573m00000004DC9', baseLiveAgentURL: 'https://d.la4-c1cs-phx.salesforceliveagent.com/chat', eswLiveAgentDevName: 'EmbeddedServiceLiveAgent_Parent04Im0000000001iEAA_16369f295e6', isOfflineSupportEnabled: false}); };if (!window.embedded_svc) { var s = document.createElement('script'); s.setAttribute('src', 'https://dellservices--DEV3.cs20.my.salesforce.com/embeddedservice/5.0/esw.min.js'); s.onload = function() { initESW(null, deploymentId, buttonId, serviceTagVal, issueVal); }; document.body.appendChild(s); } else { initESW('https://service.force.com', deploymentId, buttonId, serviceTagVal, issueVal); }
    }
</script>
</html>