<html>
    <head>
        <script type='text/javascript' src='https://c.la1-c1cs-phx.salesforceliveagent.com/content/g/js/42.0/deployment.js'></script>
        
        <script>

            liveagent.details.preChatInit('https://d.la1-c1cs-phx.salesforceliveagent.com/chat','detailCallback');
            
            var detailCallback = function (details){
                for (var i = 0; i < details.customDetails.length; i++) 
                {
                    if(details.customDetails[i].label == 'caseServiceTag')
                        document.getElementById('prechat_field_service_tag').value = details.customDetails[i].value;
                    
                    else if(details.customDetails[i].label == 'CaseSubject')
                         document.getElementById('subject').value = details.customDetails[i].value;
                }
            };
        
        </script>
        
        
         <script type="text/javascript">
         
        
        
         (function() { 
          function handlePageLoad() {
              if(window.innerWidth)
            {
            window.resizeTo(500 + (window.outerWidth - window.innerWidth),650 + (window.outerHeight - window.innerHeight));
            }
             else
             {
            window.resizeTo(500,500);
            window.resizeTo(500 + (500-document.body.offsetWidth),650 + (500-document.body.offsetHeight));
            }

              var endpointMatcher = new RegExp("[\\?\\&]endpoint=([^&#]*)");
              var endpoint = getParameterByName('endpoint');
              var buttonid = getParameterByName('button_id',endpoint);
              console.log('button_id======='+buttonid);
              document.getElementById('btnid').value = buttonid;
            document.getElementById('prechatForm').setAttribute('action',decodeURIComponent(endpointMatcher.exec(document.location.search)[1]));
            if(window.innerWidth)
            {
            window.resizeTo(500 + (window.outerWidth - window.innerWidth),650 + (window.outerHeight - window.innerHeight));
            }
             else
             {
            window.resizeTo(500,500);
            window.resizeTo(500 + (500-document.body.offsetWidth),650 + (500-document.body.offsetHeight));
            }

           }
            if (window.addEventListener) {
              window.addEventListener('load', handlePageLoad, false);
            } else { 
              window.attachEvent('onload', handlePageLoad, false);
            }
            })();

     
        function getParameterByName(name, url) {
        if (!url) {
          url = window.top.location.href;
        }
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    } 
        
 </script>    
       
        
        
        
 
      <title>Pre-Chat Form</title>
      <link rel="stylesheet" type="text/css" media="screen" href="/node_modules/bootstrap/dist/css/bootstrap.min.css" />
      <link rel="stylesheet" type="text/css" media="screen" href="/main.css" />
    </head>

 <body>
    <nav class="navbar navbar-light bg-light">
        <a class="navbar-brand" href="#">
            <img src="/assets/DellTech_Logo_Prm_Blue.jpg" class="d-inline-block align-top" alt="">
        </a>
    </nav>
    <div class="container">
      <div class="row">
        <div class="col-lg-2"></div>
        <div class="col-lg-8">
          <form method="post" id="prechatForm">
            <div class="form-group">
                <label for="firstName">First Name</label>
                <input type="text" class="form-control"  id="firstName" aria-describedby="firstName" placeholder="First Name" name="liveagent.prechat:contactFirstName"  autofocus="true"  maxlength="80">
            </div>
            <div class="form-group">
                <label for="lastName">Last Name</label>
                <input type="text" class="form-control"  id="lastName" aria-describedby="lastName" placeholder="Last Name" name="liveagent.prechat:contactLastName" required="required" autofocus="true" maxlength="80">
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="text" class="form-control"  id="email" aria-describedby="email" placeholder="Email" name="liveagent.prechat:contactEmail"  maxlength="80">
            </div>
            <div class="form-group">
                <label for="phoneNumber">Phone</label>
                <input type="text" class="form-control"  id="phoneNumber" aria-describedby="phoneNumber" placeholder="Phone" name="liveagent.prechat:contactPhone" required="required" maxlength="100">
            </div>
            <div class="form-group">
                <label for="subject">Subject</label>
                <input type="text" class="form-control"  id="subject" aria-describedby="subject" placeholder="Subject" name="liveagent.prechat:caseSubject" autofocus="true"  maxlength="80">
            </div>
            <div class="form-group">
                <label for="serviceTag">Service Tag</label>
                <input type="text" class="form-control"  id="serviceTag" aria-describedby="serviceTag" placeholder="Service Tag" name="liveagent.prechat:caseServiceTag" required="required" autofocus="true"  maxlength="80">
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <input type="text" class="form-control"  id="description" aria-describedby="description" placeholder="Description" name="liveagent.prechat:caseDescription"  autofocus="true"  maxlength="80">
            </div>

            <!-- Detail inputs -->
            <!-- hidden fields -->
            <input type="hidden" name="liveagent.prechat:isclosed" value="false" />
            <input type="hidden" name="liveagent.prechat:status" value="New" />
            <input type="hidden" name="liveagent.prechat:origin" value="Chat" />
            <input type="hidden" name="liveagent.prechat.name" id="prechat_field_name" />
            <input type="hidden" id="btnid" name="liveagent.prechat:button"/> 
                        
                        
            <!-- save inputs to transcripts  -->          
            <input type="hidden" name="liveagent.prechat.save:contactFirstName" value="FirstName__c" />
            <input type="hidden" name="liveagent.prechat.save:contactLastName" value="LastName__c" />  
            <input type="hidden" name="liveagent.prechat.save:contactEmail" value="Email__c" />  
            <input type="hidden" name="liveagent.prechat.save:contactPhone" value="ContactNumber__c" />
            <input type="hidden" name="liveagent.prechat.save:customerNumber" value="CustomerNumber__c" />   
            <input type="hidden" name="liveagent.prechat.save:customerBUID" value="CustomerBUID__c" /> 
            <input type="hidden" name="liveagent.prechat.save:caseSubject" value="Issue__c" />  
            <input type="hidden" name="liveagent.prechat.save:caseServiceTag" value="Service_Tag__c" />  
            <input type="hidden" name="liveagent.prechat.save:caseSR" value="Service_Request_Number__c" />  
            <input type="hidden" name="liveagent.prechat.save:caseDescription" value="Description__c" />     
                      
                          
            <!--Map the detail inputs to the Asset fields -->
            <input type="hidden" name="liveagent.prechat.findorcreate.map:Asset" value="Name,caseServiceTag" />    

            <!-- find the Asset -->
            <input type="hidden" name="liveagent.prechat.findorcreate.map.doFind:Asset" value="Name,true" />
            <input type="hidden" name="liveagent.prechat.findorcreate.map.isExactMatch:Asset" value="Name,true" />  

            <!-- Link the Asset to the Case -->  
            <input type= "hidden" name="liveagent.prechat.findorcreate.linkToEntity:Asset" value="Case,AssetId" />  

            <!-- saveToTranscript: Associates the records found / created, i.e. Contact, Case and Asset to the Live Chat Transcript record. -->
            <input type="hidden" name="liveagent.prechat.findorcreate.saveToTranscript:Asset" value="Asset__c" />          



            <input type="submit" value="Request Chat" id="prechat_submit" onclick="setName()" />


                        
            <script type="text/javascript">
              function setName() {
                document.getElementById("prechat_field_name").value =  
                    document.getElementById("firstName").value + " " + document.getElementById("lastName").value;
                }

            </script>
          </form>
        </div>
      </div>
    </div> 
</body>
  </html>